<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Address Validator</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>US Address Validator</h1>
            <p class="subtitle">Validate US addresses in real-time</p>
        </div>

        <div class="demo-section">
            <p class="intro">Try the address validation API:</p>

            <form id="addressForm" class="demo-form">
                <div class="form-row">
                    <div class="field">
                        <label for="addressLine1">Street Address Line 1 *</label>
                        <input type="text" id="addressLine1" name="addressLine1" placeholder="e.g., 1600 Amphitheatre Parkway" maxlength="100" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="field">
                        <label for="addressLine2">Street Address Line 2</label>
                        <input type="text" id="addressLine2" name="addressLine2" placeholder="e.g., Suite 100 (optional)" maxlength="100">
                    </div>
                </div>

                <div class="form-row two-col">
                    <div class="field">
                        <label for="city">City *</label>
                        <input type="text" id="city" name="city" placeholder="e.g., Mountain View" maxlength="50" required>
                    </div>
                    <div class="field">
                        <label for="state">State *</label>
                        <input list="states" type="text" id="state" name="state" placeholder="CA" maxlength="20" required>
                        <datalist id="states">
                            <option value="Alabama">
                            <option value="Alaska">
                            <option value="Arizona">
                            <option value="Arkansas">
                            <option value="California">
                            <option value="Colorado">
                            <option value="Connecticut">
                            <option value="Delaware">
                            <option value="District of Columbia">
                            <option value="Florida">
                            <option value="Georgia">
                            <option value="Hawaii">
                            <option value="Idaho">
                            <option value="Illinois">
                            <option value="Indiana">
                            <option value="Iowa">
                            <option value="Kansas">
                            <option value="Kentucky">
                            <option value="Louisiana">
                            <option value="Maine">
                            <option value="Maryland">
                            <option value="Massachusetts">
                            <option value="Michigan">
                            <option value="Minnesota">
                            <option value="Mississippi">
                            <option value="Missouri">
                            <option value="Montana">
                            <option value="Nebraska">
                            <option value="Nevada">
                            <option value="New Hampshire">
                            <option value="New Jersey">
                            <option value="New Mexico">
                            <option value="New York">
                            <option value="North Carolina">
                            <option value="North Dakota">
                            <option value="Ohio">
                            <option value="Oklahoma">
                            <option value="Oregon">
                            <option value="Pennsylvania">
                            <option value="Rhode Island">
                            <option value="South Carolina">
                            <option value="South Dakota">
                            <option value="Tennessee">
                            <option value="Texas">
                            <option value="Utah">
                            <option value="Vermont">
                            <option value="Virginia">
                            <option value="Washington">
                            <option value="West Virginia">
                            <option value="Wisconsin">
                            <option value="Wyoming">
                            <option value="American Samoa">
                            <option value="Guam">
                            <option value="Northern Mariana Islands">
                            <option value="Puerto Rico">
                            <option value="U.S. Virgin Islands">
                        </datalist>
                    </div>
                </div>

                <div class="form-row">
                    <div class="field">
                        <label for="zip">ZIP Code *</label>
                        <input type="text" id="zip" name="zip" placeholder="e.g., 94043" maxlength="5" pattern="\d{5}" required>
                        <span id="zipTooltip" class="tooltip"></span>
                    </div>
                </div>

                <div class="button-group">
                    <button type="submit" class="btn-primary">Validate Address</button>
                    <button type="button" class="btn-sample" id="sampleBtn">Try Sample Address</button>
                </div>
            </form>
        </div>

        <div id="response" class="response" style="display:none;"></div>
    </div>
    <script>
        // Sample address data
        const sampleAddress = {
            addressLine1: '1600 Amphitheatre Parkway',
            addressLine2: '',
            city: 'Mountain View',
            state: 'California',
            zip: '94043'
        };

        // Populate form with sample address
        document.getElementById('sampleBtn').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('addressLine1').value = sampleAddress.addressLine1;
            document.getElementById('addressLine2').value = sampleAddress.addressLine2;
            document.getElementById('city').value = sampleAddress.city;
            document.getElementById('state').value = sampleAddress.state;
            document.getElementById('zip').value = sampleAddress.zip;
        });

        // ZIP input enforcement and tooltip
        const zipInput = document.getElementById('zip');
        const zipTooltip = document.getElementById('zipTooltip');
        zipInput.addEventListener('input', function() {
            if (/[^0-9]/.test(this.value)) {
                zipTooltip.textContent = 'Please enter digits only';
                zipTooltip.classList.add('show');
            } else {
                zipTooltip.textContent = '';
                zipTooltip.classList.remove('show');
            }
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        document.getElementById('addressForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const responseDiv = document.getElementById('response');
            const addressLine1 = document.getElementById('addressLine1').value.trim();
            const addressLine2 = document.getElementById('addressLine2').value.trim();
            const city = document.getElementById('city').value.trim();
            const state = document.getElementById('state').value.trim();
            const zip = document.getElementById('zip').value.trim();

            // client-side length validation
            const errors = [];
            if (addressLine1.length === 0 || addressLine1.length > 100) {
                errors.push('Address Line 1 must be 1-100 characters.');
            }
            if (addressLine2.length > 100) {
                errors.push('Address Line 2 cannot exceed 100 characters.');
            }
            if (city.length === 0 || city.length > 50) {
                errors.push('City must be 1-50 characters.');
            }
            if (state.length === 0 || state.length > 20) {
                errors.push('State must be 1-20 characters.');
            }
            // ensure state is one of allowed values
            const allowedStates = [
                'Alabama','Alaska','Arizona','Arkansas','California','Colorado','Connecticut','Delaware','District of Columbia','Florida','Georgia','Hawaii','Idaho','Illinois','Indiana','Iowa','Kansas','Kentucky','Louisiana','Maine','Maryland','Massachusetts','Michigan','Minnesota','Mississippi','Missouri','Montana','Nebraska','Nevada','New Hampshire','New Jersey','New Mexico','New York','North Carolina','North Dakota','Ohio','Oklahoma','Oregon','Pennsylvania','Rhode Island','South Carolina','South Dakota','Tennessee','Texas','Utah','Vermont','Virginia','Washington','West Virginia','Wisconsin','Wyoming','American Samoa','Guam','Northern Mariana Islands','Puerto Rico','U.S. Virgin Islands'
            ];
            if (state && !allowedStates.includes(state)) {
                errors.push('Please select a valid state or territory from the list.');
            }
            if (!/^\d{5}$/.test(zip)) {
                errors.push('Zip code must be exactly 5 digits.');
            }
            if (errors.length) {
                responseDiv.className = 'response error';
                responseDiv.innerHTML = '<strong>Validation Errors:</strong><ul>' + 
                    errors.map(e => '<li>' + e + '</li>').join('') + '</ul>';
                responseDiv.style.display = 'block';
                return;
            }

            // Show loading state
            responseDiv.className = 'response loading';
            responseDiv.textContent = 'Validating address...';
            responseDiv.style.display = 'block';

            fetch('/validate-address', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ addressLine1, addressLine2, city, state, zip })
            })
            .then(response => response.json())
            .then(data => {
                responseDiv.className = 'response success';
                responseDiv.innerHTML = '<strong>Validation Result:</strong><pre>' + 
                    JSON.stringify(data, null, 2) + '</pre>';
                responseDiv.style.display = 'block';
            })
            .catch(error => {
                responseDiv.className = 'response error';
                responseDiv.innerHTML = '<strong>Error:</strong> <p>' + error.message + '</p>';
                responseDiv.style.display = 'block';
            });
        });
    </script>
</body>
</html>